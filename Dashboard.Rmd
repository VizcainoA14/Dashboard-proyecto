---
title: "Tecnologias, herramientas y lenguajes de programacion 1960-2023"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}

library(flexdashboard)
library(readxl)
library(tidyverse)
library(plotly)

Data <- read_excel("Data.xlsx")

# Calculo del numero de muestra

n <- ((1.96**2) * ((1336/3989) * (1 - (1336/3989)))) / (0.02**2)
n <- round(n)
# Tamaño de meustra para proporciones


set.seed(00065280) # Establecer una semilla para reproducibilidad
tamano_muestra <- n # Reemplaza 'n' con el tamaño deseado de la muestra
Muestra <- Data[sample(nrow(Data), tamano_muestra), ]


# Muestreo aleatorio
library(zoo)

# Reemplazar NA por la mediana en variables numéricas
Muestra$appeared <- na.aggregate(Muestra$appeared, FUN = median)
Muestra$lastActivity <- na.aggregate(Muestra$lastActivity, FUN = median)
Muestra$numberOfUsers <- na.aggregate(Muestra$numberOfUsers, FUN = median)

# Reemplazar NA por la moda en variables categóricas
Mode <- function(x) {
  uniq_x <- unique(x)
  uniq_x[which.max(tabulate(match(x, uniq_x)))]
}
Muestra$type <- na.aggregate(Muestra$type, FUN = function(x) Mode(x)[1])
Muestra$website <- na.aggregate(Muestra$website, FUN = function(x) Mode(x)[1])
Muestra$country <- na.aggregate(Muestra$country, FUN = function(x) Mode(x)[1])

histograma <- hist(Data$appeared, plot = FALSE)

# Normalizar el histograma
histograma$counts <- histograma$counts / sum(histograma$counts)

# Dibujar el histograma normalizado
barplot(histograma$counts, names.arg = histograma$mids, main = "Histograma Normalizado", xlab = "Valores", ylab = "Frecuencia Relativa")




```

APPEARED{data-navmenu="Variables Cuantitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Histograma
```{r}

histograma <- ggplot(data = Muestra, aes(x = appeared)) +
  geom_histogram(bins = 63, color = "#000000", fill ="dodgerblue") +
  labs(title = "Histograma de 'appeared' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))
  


fig <- ggplotly(histograma)
fig

```


### Densidad

```{r}

DensityAPP <- ggplot(data = Muestra, aes(x = appeared)) +
  geom_density() +
  labs(title = "Densidad de 'appeared' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(DensityAPP)


```


### Boxplot

```{r}

box_APP =ggplot(data = Muestra, aes(x = "", y = appeared)) + 
          geom_boxplot(outlier.shape = NA) +
          geom_jitter(shape = 17,colour = "#7AC5CD", size = 0.7)+
          labs(title = "Boxplot de 'appeared' en Muestra")+
          theme(plot.title = element_text(hjust = 0.5))

ggplotly(box_APP)




```

### Q-Q

```{r}

qqAPP = ggplot(Muestra, aes(sample=appeared)) +
  stat_qq(color='#7AC5CD') + 
  stat_qq_line()+
  labs(title = "Grafico Q-Q de 'appeared' en Muestra")+
  theme(plot.title = element_text(hjust = 0.5))
ggplotly(qqAPP)




```






Rows {data-width=400}
---------------
### Conclusiones
Basándonos en las gráficas y lo que hemos estudiado en nuestro curso de Estadística Inferencial, parece que las muestras no se ajustan a una distribución normal, debido a que:

* El histograma revelan asimetría y un sesgo hacia la derecha, lo que sugiere una distribución no normal. Este patrón de desviación se refleja de manera consistente en los gráficos de densidad, proporcionando una indicación adicional de la falta de normalidad en los datos."

* Igualmente el grafico Q-Q muestra colas tanto izquierda como derechas 

 
### Preguntas interesantes

```{r}

```










LAST ACTIVITY{data-navmenu="Variables Cuantitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Histograma
```{r}

histogramaLA <- ggplot(data = Muestra, aes(x = lastActivity)) +
  geom_histogram(bins = 63, color = "#000000", fill ="dodgerblue") +
  labs(title = "Histograma de 'lastActivity' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))
  


ggplotly(histogramaLA)


```


### Densidad

```{r}

DensityLA <- ggplot(data = Muestra, aes(x = lastActivity)) +
  geom_density() +
  labs(title = "Densidad de 'lastActivity' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(DensityLA)


```


### Boxplot

```{r}

box_LA =ggplot(data = Muestra, aes(x = "", y = lastActivity)) + 
          geom_boxplot(outlier.shape = NA) +
          geom_jitter(shape = 17,colour = "#7AC5CD", size = 0.7)+
          labs(title = "Boxplot de 'lastActivity' en Muestra")+
          theme(plot.title = element_text(hjust = 0.5))

ggplotly(box_LA)




```

### Q-Q

```{r}

qqLA = ggplot(Muestra, aes(sample=lastActivity)) +
  stat_qq(color='#7AC5CD') + 
  stat_qq_line()+
  labs(title = "Grafico Q-Q de 'lastActivity' en Muestra")+
  theme(plot.title = element_text(hjust = 0.5))
ggplotly(qqLA)




```


Rows {data-width=400}
---------------
### Conclusiones

```{r}

```

 
### Preguntas interesantes

```{r}

```


NUMBER OF USERS{data-navmenu="Variables Cuantitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Histograma
```{r}

histogramaNU <- ggplot(data = Muestra, aes(x = numberOfUsers)) +
  geom_histogram(bins = 63, color = "#000000", fill ="dodgerblue") +
  labs(title = "Histograma de 'numberOfUsers' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))
  


ggplotly(histogramaNU)


```


### Densidad

```{r}

DensityNU <- ggplot(data = Muestra, aes(x = numberOfUsers)) +
  geom_density() +
  labs(title = "Densidad de 'lastActivity' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(DensityNU)


```


### Boxplot

```{r}

box_NU =ggplot(data = Muestra, aes(x = "", y = numberOfUsers)) + 
          geom_boxplot(outlier.shape = NA) +
          geom_jitter(shape = 17,colour = "#7AC5CD", size = 0.7)+
          labs(title = "Boxplot de 'lastActivity' en Muestra")+
          theme(plot.title = element_text(hjust = 0.5))

ggplotly(box_NU)




```

### Q-Q

```{r}

qqNU = ggplot(Muestra, aes(sample=numberOfUsers)) +
  stat_qq(color='#7AC5CD') + 
  stat_qq_line()+
  labs(title = "Grafico Q-Q de 'lastActivity' en Muestra")+
  theme(plot.title = element_text(hjust = 0.5))
ggplotly(qqNU)




```






Rows {data-width=400}
---------------
### Conclusiones

```{r}

```

 
### Preguntas interesantes

```{r}

```









