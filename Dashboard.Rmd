---
title: "Tecnologias, herramientas y lenguajes de programacion 1960-2023"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}

library(flexdashboard)
library(readxl)
library(tidyverse)
library(plotly)
library(knitr)

Data <- read_excel("Data.xlsx")

# Calculo del numero de muestra

n <- ((1.96**2) * ((1336/3989) * (1 - (1336/3989)))) / (0.02**2)
n <- round(n)
# Tamaño de meustra para proporciones


set.seed(00065280) # Establecer una semilla para reproducibilidad
tamano_muestra <- n # Reemplaza 'n' con el tamaño deseado de la muestra
Muestra <- Data[sample(nrow(Data), tamano_muestra), ]


# Muestreo aleatorio
library(zoo)

# Reemplazar NA por la mediana en variables numéricas
Muestra$appeared <- na.aggregate(Muestra$appeared, FUN = median)
Muestra$lastActivity <- na.aggregate(Muestra$lastActivity, FUN = median)
Muestra$numberOfUsers <- na.aggregate(Muestra$numberOfUsers, FUN = median)

# Reemplazar NA por la moda en variables categóricas
Mode <- function(x) {
  uniq_x <- unique(x)
  uniq_x[which.max(tabulate(match(x, uniq_x)))]
}
Muestra$type <- na.aggregate(Muestra$type, FUN = function(x) Mode(x)[1])
Muestra$website <- na.aggregate(Muestra$website, FUN = function(x) Mode(x)[1])
Muestra$country <- na.aggregate(Muestra$country, FUN = function(x) Mode(x)[1])

histograma <- hist(Data$appeared, plot = FALSE)

# Normalizar el histograma
histograma$counts <- histograma$counts / sum(histograma$counts)

# Dibujar el histograma normalizado
barplot(histograma$counts, names.arg = histograma$mids, main = "Histograma Normalizado", xlab = "Valores", ylab = "Frecuencia Relativa")




```

APPEARED{data-navmenu="Variables Cuantitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Histograma
```{r}

histograma <- ggplot(data = Muestra, aes(x = appeared)) +
  geom_histogram(bins = 63, color = "#000000", fill ="dodgerblue") +
  labs(title = "Histograma de 'appeared' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))
  


fig <- ggplotly(histograma)
fig

```


### Densidad

```{r}

DensityAPP <- ggplot(data = Muestra, aes(x = appeared)) +
  geom_density() +
  labs(title = "Densidad de 'appeared' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(DensityAPP)


```


### Boxplot

```{r}

box_APP =ggplot(data = Muestra, aes(x = "", y = appeared)) + 
          geom_boxplot(outlier.shape = NA) +
          geom_jitter(shape = 17,colour = "#7AC5CD", size = 0.7)+
          labs(title = "Boxplot de 'appeared' en Muestra")+
          theme(plot.title = element_text(hjust = 0.5))

ggplotly(box_APP)




```

### Q-Q

```{r}

datos_normales <- rnorm(100, mean = 0, sd = 1)

qqAPP = ggplot(Muestra, aes(sample=appeared)) +
  stat_qq(color='#7AC5CD') + 
  stat_qq_line()+
  labs(title = "Grafico Q-Q de 'appeared' en Muestra")+
  theme(plot.title = element_text(hjust = 0.5))
ggplotly(qqAPP)
```






Rows {data-width=400}
---------------
### Conclusiones
Basándonos en las gráficas y lo que hemos estudiado en nuestro curso de Estadística Inferencial, parece que las muestras no se ajustan a una distribución normal, debido a que:

* El histograma presenta asimetría y un sesgo hacia la derecha, lo que sugiere una distribución no normal. Este patrón de desviación se refleja de manera consistente en los gráficos de densidad, proporcionando una indicación adicional de la falta de normalidad en los datos."

* Igualmente el grafico Q-Q muestra colas tanto izquierda como derechas, lo cual  indica que hay valores por encima de los cuantiles -2 y 2, lo cual es otro indicio de la no normalidad de los datos

 
### Datos

```{r}
DT::datatable(data = Muestra[, c(1, 2)], 
              extensions = 'Scroller',
              options = list(dom='tp',  
                             class = 'stripe compact hover cell-border'))

```










LAST ACTIVITY{data-navmenu="Variables Cuantitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Histograma
```{r}

histogramaLA <- ggplot(data = Muestra, aes(x = lastActivity)) +
  geom_histogram(bins = 63, color = "#000000", fill ="dodgerblue") +
  labs(title = "Histograma de 'lastActivity' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))
  


ggplotly(histogramaLA)


```


### Densidad

```{r}

DensityLA <- ggplot(data = Muestra, aes(x = lastActivity)) +
  geom_density() +
  labs(title = "Densidad de 'lastActivity' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(DensityLA)


```


### Boxplot

```{r}

box_LA =ggplot(data = Muestra, aes(x = "", y = lastActivity)) + 
          geom_boxplot(outlier.shape = NA) +
          geom_jitter(shape = 17,colour = "#7AC5CD", size = 0.7)+
          labs(title = "Boxplot de 'lastActivity' en Muestra")+
          theme(plot.title = element_text(hjust = 0.5))

ggplotly(box_LA)




```

### Q-Q

```{r}

qqLA = ggplot(Muestra, aes(sample=lastActivity)) +
  stat_qq(color='#7AC5CD') + 
  stat_qq_line()+
  labs(title = "Grafico Q-Q de 'lastActivity' en Muestra")+
  theme(plot.title = element_text(hjust = 0.5))
ggplotly(qqLA)




```


Rows {data-width=400}
---------------
### Conclusiones
Teniendo en cuenta las graficas de la variable 'lastActivity' podemos inferir que:

* Tanto el histograma como el gráfico de densidad exhiben un sesgo hacia la derecha, lo que indica una clara asimetría en la distribución de los datos y una cola más larga hacia los valores superiores, evidenciando que la distribución no es normal, afirmacion que es ratficada en el grafico Q-Q

* Por otro lado, aunque el Boxplot no muestra valores atípicos, sí revela un sesgo hacia los valores altos de la variable.

 
### Datos

```{r}
DT::datatable(data = Muestra[, c(1, 4)], 
              extensions = 'Scroller',
              options = list(dom='tp',  
                             class = 'stripe compact hover cell-border'))

```


NUMBER OF USERS{data-navmenu="Variables Cuantitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Histograma
```{r}

histogramaNU <- ggplot(data = Muestra, aes(x = numberOfUsers)) +
  geom_histogram(bins = 50, color = "#000000", fill ="dodgerblue") +
  labs(title = "Histograma de 'numberOfUsers' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))





ggplotly(histogramaNU)


```


### Densidad

```{r}

DensityNU <- ggplot(data = Muestra, aes(x = numberOfUsers)) +
  geom_density() +
  labs(title = "Densidad de 'lastActivity' en Muestra") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(DensityNU)


```


### Boxplot

```{r}

box_NU =ggplot(data = Muestra, aes(x = "", y = numberOfUsers)) + 
          geom_boxplot(outlier.shape = NA) +
          geom_jitter(shape = 17,colour = "#7AC5CD", size = 0.7)+
          labs(title = "Boxplot de 'lastActivity' en Muestra")+
          theme(plot.title = element_text(hjust = 0.5))

ggplotly(box_NU)




```

### Q-Q

```{r}

qqNU = ggplot(Muestra, aes(sample=numberOfUsers)) +
  stat_qq(color='#7AC5CD') + 
  stat_qq_line()+
  labs(title = "Grafico Q-Q de 'lastActivity' en Muestra")+
  theme(plot.title = element_text(hjust = 0.5))
ggplotly(qqNU)




```

Rows {data-width=400}
---------------
### Conclusiones
Considerando las gráficas analizadas, se puede concluir que la variable 'numberOfUser' exhibe características distintivas:

* Tanto el gráfico Q-Q como el Boxplot revelan la existencia de numerosos valores atípicos (outliers). Esta observación sugiere que los datos presentan una gran variabilidad y no se distribuyen normalmente, ya que los valores extremos afectan la normalidad de la distribución.

* Además, el histograma y el gráfico de densidad muestran un sesgo notable hacia la izquierda. Este sesgo indica que hay una concentración significativa de valores en el extremo inferior de la escala, lo que contribuye aún más a la falta de normalidad en los datos.

 
### Datos

```{r}
DT::datatable(data = Muestra[, c(1, 5)], 
              extensions = 'Scroller',
              options = list(dom='tp',  
                             class = 'stripe compact hover cell-border'))

```






<!-- pon tus vainas aqui pipe -->

TYPE{data-navmenu="Variables Cualitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Grafico de barras
```{r}

# Gráfico de barras para Type
x=ggplot(Muestra, aes(x = type)) +
  geom_bar() +
  labs(title = "Gráfico de Barras para TYPE")

p= ggplotly(x)
p

```

Rows {data-width=400}
---------------
### Conclusiones
Basándonos en las gráficas y lo que hemos estudiado en nuestro curso de Estadística Inferencial, parece que las muestras no se ajustan a una distribución normal, debido a que:

* El histograma presenta asimetría y un sesgo hacia la derecha, lo que sugiere una distribución no normal. Este patrón de desviación se refleja de manera consistente en los gráficos de densidad, proporcionando una indicación adicional de la falta de normalidad en los datos."

* Igualmente el grafico Q-Q muestra colas tanto izquierda como derechas, lo cual  indica que hay valores por encima de los cuantiles -2 y 2, lo cual es otro indicio de la no normalidad de los datos

 
### Datos

```{r}
DT::datatable(data = Muestra[, c(1, 3)], 
              extensions = 'Scroller',
              options = list(dom='tp',  
                             class = 'stripe compact hover cell-border'))

```










COUNTRY{data-navmenu="Variables Cualitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Grafico de torta
```{r}

values = table(Muestra$country)
labels = names(sort(values,decreasing = T))
values = sort(values,decreasing = T)
fig <- plot_ly(type='pie', labels=labels, values=values, 
                textinfo='label+percent',
                insidetextorientation='radial')
fig




```

Rows {data-width=400}
---------------
### Conclusiones
Teniendo en cuenta las graficas de la variable 'lastActivity' podemos inferir que:

* Tanto el histograma como el gráfico de densidad exhiben un sesgo hacia la derecha, lo que indica una clara asimetría en la distribución de los datos y una cola más larga hacia los valores superiores, evidenciando que la distribución no es normal, afirmacion que es ratficada en el grafico Q-Q

* Por otro lado, aunque el Boxplot no muestra valores atípicos, sí revela un sesgo hacia los valores altos de la variable.

 
### Datos

```{r}
DT::datatable(data = Muestra[, c(1, 7)], 
              extensions = 'Scroller',
              options = list(dom='tp',  
                             class = 'stripe compact hover cell-border'))

```


WEBSITE{data-navmenu="Variables Cualitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------
### Grafico de barras
```{r}

# Gráfico de barras para Variable3
x=ggplot(Muestra, aes(x = website)) +
  geom_bar() +
  labs(title = "Gráfico de Barras para WEBSITE")
p = ggplotly(x)
x

```


Rows {data-width=400}
---------------
### Conclusiones
Considerando las gráficas analizadas, se puede concluir que la variable 'numberOfUser' exhibe características distintivas:

* Tanto el gráfico Q-Q como el Boxplot revelan la existencia de numerosos valores atípicos (outliers). Esta observación sugiere que los datos presentan una gran variabilidad y no se distribuyen normalmente, ya que los valores extremos afectan la normalidad de la distribución.

* Además, el histograma y el gráfico de densidad muestran un sesgo notable hacia la izquierda. Este sesgo indica que hay una concentración significativa de valores en el extremo inferior de la escala, lo que contribuye aún más a la falta de normalidad en los datos.

 
### Datos

```{r}
DT::datatable(data = Muestra[, c(1, 6)], 
              extensions = 'Scroller',
              options = list(dom='tp',  
                             class = 'stripe compact hover cell-border'))

```
Tablas de contingencia{data-navmenu="Variables Cualitativas"}
==============

Rows {data-width=600, .tabset}
-----------------------------------------------------------------------

### Tablas de contigencia 1 

```{r}
# Calcular la tabla de contingencia entre Type y country
tabla_type_country <- table(Muestra$type, Muestra$country)
kable(tabla_type_country)

```
### Tabla de contigencia 2
```{r}
# Calcular la tabla de contingencia entre country y website
tabla_country_website <- table(Muestra$country, Muestra$website)
kable(tabla_country_website)
```
### Tabla de contingencia 3
```{r}
# Calcular la tabla de contingencia entre website y type
tabla_website_type <- table(Muestra$type, Muestra$website)
kable(tabla_website_type)
```




Pregunta 1 {data-navmenu="Preguntas interesantes"}
=======================









